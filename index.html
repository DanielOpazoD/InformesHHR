<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Registro Cl√≠nico ‚Äì Hospital Hanga Roa</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="assets/css/main.css" />
</head>
<body>
  <!-- Barra superior -->
  <div class="topbar">
    <select id="titleSelect" class="inp" style="width:auto;">
      <option value="1">Informe m√©dico de traslado - Hospital Hanga Roa</option>
      <option value="2" selected>Evoluci√≥n m√©dica (FECHA) - Hospital Hanga Roa</option>
      <option value="3">Epicrisis m√©dica</option>
      <option value="4">Epicrisis m√©dica de traslado</option>
      <option value="5">Otro (personalizado)</option>
      <option value="6">Informe m√©dico - Hospital Hanga Roa</option>
    </select>
    <button id="btnPrint" class="btn" type="button">Imprimir / Guardar PDF</button>
    <button id="toggleEdit" class="btn" type="button">Editar secciones</button>
    <button id="toggleAI" class="btn" type="button">Panel IA</button>
    <button id="exportJson" class="btn" type="button" title="Exportar registro (.json)">Exportar</button>
    <label class="btn" for="importJson" title="Importar registro (.json)">Importar</label>
    <input id="importJson" type="file" accept="application/json" style="display:none" />
  </div>

  <div class="wrap">
    <div class="sheet" id="sheet">
      <img id="logoLeft" src="https://iili.io/FEirDCl.png" class="absolute top-2 left-2 w-16 h-auto opacity-80" alt="Logo Izquierdo">
      <img id="logoRight" src="https://iili.io/FEirQjf.png" class="absolute top-2 right-2 w-16 h-auto opacity-80" alt="Logo Derecho">

      <!-- Panel edici√≥n -->
      <div id="editPanel" class="edit-panel">
        <div class="text-sm font-semibold text-slate-700">Edici√≥n</div>
        <button id="addSecBtn" class="btn" type="button">Agregar secci√≥n</button>
        <button id="delSecBtn" class="btn" type="button">Eliminar √∫ltima secci√≥n</button>
        <hr class="my-1">
        <div class="text-xs text-slate-500">Campos del paciente</div>
        <button id="addPatientFieldBtn" class="btn" type="button" title="Agregar nuevo campo en Informaci√≥n del Paciente">Agregar campo</button>
        <button id="restorePatientBtn" class="btn" type="button" title="Restaurar campos por defecto">Restaurar campos</button>
        <hr class="my-1">
        <button id="restoreBtn" class="btn" type="button" title="Restaurar estructura y contenido por defecto">Restaurar todo</button>
      </div>

      <!-- T√≠tulo principal -->
      <div id="titleDisplay" class="title" contenteditable="true">Evoluci√≥n m√©dica (____) - Hospital Hanga Roa</div>

      <!-- Datos Paciente (editable: t√≠tulos y filas eliminables) -->
      <div class="sec" id="sec-datos">
        <div class="subtitle" contenteditable="true">Informaci√≥n del Paciente</div>
        <div class="grid-2" id="patientGrid"></div>
      </div>

      <!-- Secciones din√°micas -->
      <div id="sectionsContainer"></div>

      <!-- Datos m√©dico -->
      <div class="sec" style="margin-top:12px;">
        <div class="grid-2">
          <div class="row"><div class="lbl">Nombre m√©dico</div><input class="inp" id="medico"></div>
          <div class="row"><div class="lbl">Especialidad</div><input class="inp" id="esp"></div>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="assets/js/main.js"></script>

  <aside id="aiDrawer" class="ai-drawer" aria-hidden="true">
    <div class="ai-resize-handle" data-ai-resizer></div>
    <div class="ai-drawer-inner">
      <header class="ai-drawer-header">
        <div>
          <h3 class="ai-drawer-title">Asistente IA</h3>
          <p class="ai-drawer-subtitle" data-ai-subtitle>Analiza el caso cl√≠nico completo</p>
        </div>
        <div class="ai-header-actions">
          <button class="ai-ghost-btn" type="button" data-ai-settings-toggle title="Configuraci√≥n">
            ‚öôÔ∏è
          </button>
          <button class="ai-close-btn" type="button" data-ai-close title="Cerrar panel">‚úï</button>
        </div>
      </header>

      <section class="ai-panel-settings" data-ai-settings>
        <div class="ai-settings-grid">
          <label class="ai-field">
            <span>API Key Gemini</span>
            <input type="password" data-ai-api-key placeholder="AIza..." autocomplete="off" />
          </label>
          <label class="ai-field">
            <span>ID de proyecto (Vertex)</span>
            <input type="text" data-ai-project placeholder="Opcional" autocomplete="off" />
          </label>
          <label class="ai-field">
            <span>Modelo preferido</span>
            <input type="text" data-ai-model placeholder="gemini-1.5-flash-latest" autocomplete="off" />
          </label>
          <label class="ai-field">
            <span>Perfil m√©dico</span>
            <select data-ai-profile>
              <option value="general">üë®‚Äç‚öïÔ∏è Medicina general</option>
              <option value="urgencias">üöë Urgencias</option>
              <option value="pediatria">üë∂ Pediatr√≠a</option>
            </select>
          </label>
          <label class="ai-check">
            <input type="checkbox" data-ai-markdown checked />
            <span>Formatear respuestas en Markdown</span>
          </label>
          <label class="ai-check">
            <input type="checkbox" data-ai-auto-model checked />
            <span>Cambiar de modelo autom√°ticamente si falla</span>
          </label>
        </div>
        <p class="ai-settings-hint">Los datos se guardan localmente en este navegador.</p>
      </section>

      <div class="ai-tabs">
        <button class="ai-tab" data-ai-mode="chat" type="button">üí¨ Conversaci√≥n</button>
        <button class="ai-tab" data-ai-mode="edit" type="button">üìù Editar secci√≥n</button>
      </div>

      <section class="ai-section-picker" data-ai-section-picker>
        <label for="aiSectionSelect">Editando secci√≥n</label>
        <select id="aiSectionSelect" data-ai-section-select></select>
      </section>

      <div class="ai-quick-actions" data-ai-actions></div>

      <div class="ai-messages" data-ai-messages>
        <div class="ai-empty" data-ai-empty>
          <p class="ai-empty-icon">ü§ñ</p>
          <p>Configura tu API Key y comienza a interactuar con el asistente.</p>
          <p class="ai-empty-hint">La IA recibe toda la ficha cl√≠nica como contexto.</p>
        </div>
      </div>
      <div class="ai-error" data-ai-error role="alert"></div>

      <div class="ai-input" data-ai-input-area>
        <textarea data-ai-input rows="2" placeholder="Haz una pregunta o pide una mejora..." spellcheck="false"></textarea>
        <button type="button" class="ai-send" data-ai-send title="Enviar">
          <span>Enviar</span>
        </button>
        <p class="ai-input-hint">Shift + Enter para nueva l√≠nea</p>
      </div>
    </div>
  </aside>
</body>
</html>
